// https://leetcode.com/problems/frequency-of-the-most-frequent-element/

package main

import (
	"fmt"
	"sort"
)

/*
analysis
	now I think this as a knap sack 0/1 on every value to reach
	starting from the biggest, if all can be met.. then it is already the max
	otherwise, try next biggest

	[1,2,3,4] k = 5
	take 4, and count out the duplciates. count=1

	ks01([1,2,3], target=4, k=5)
		# turn into weights
		[4,3,2]
		# total weight is 5
			0 1 2 3 4 5
			0 0 0 0 0 0
		4   0 0 0 0 1 1
		3   0 0 0 1 1 1
		2   0 0 1 1 1 2

		when j>wi: w[j] = max(w[j-wi]+1, w[j]) # either take it or not...



*/

func ks01(nums []int, target, k int) int {
	if len(nums) == 0 {
		return 0
	}

	wts := make([]int, len(nums))
	for i := range nums {
		wts[i] = target - nums[i]
	}

	if k < wts[len(wts)-1] {
		return 0
	}

	W := make([]int, k+1)
	for i := range W {
		W[i] = 0
	}

	// loop w needs to be out of loop j
	for _, w := range wts {
		for j := k; j >= 0; j-- {

			if j >= w {
				W[j] = max(W[j], W[j-w]+1)
			}

		}
	}

	return W[k]
}

func _1_maxFrequency(nums []int, k int) int {
	sort.Ints(nums)

	maxCount := 0
	for j := len(nums) - 1; j >= 0; j-- {
		if maxCount >= j+1 {
			break
		}

		target := nums[j]
		count := 1
		for i := j - 1; i >= 0; i-- {
			if nums[i] == target {
				count++
				j--
			} else {
				break
			}

		}

		count += ks01(nums[:j], target, k)
		maxCount = max(maxCount, count)
	}

	return maxCount
}

/*

40 / 71 test cases passed.
Status: Time Limit Exceeded
Submitted: 0 minutes ago
Last executed input:
[9974,9950,9962,9904,9955,9929,9915,9911,9996,9973,9928,9914,9932,9900,9993,9936,9942,9910,9949,9924,9960,9929,9987,9976,9962,9972,9954,9930,9979,10000,9900,9974,9972,9974,9900,9938,9919,9953,9997,9938,9966,9965,9944,9995,9909,9958,9923,9979,9991,9971,10000,9982,9950,9930,9941,9933,9914,9994,9925,9904,9901,9930,9946,9972,9920,9914,9990,9985,9935,9910,9976,9931,9994,9900,9964,9965,9918,9987,9918,9999,9936,9914,9917,9916,9976,9901,9980,9991,9971,9969,9932,9972,9917,9938,9962,9948,9940,9932,9994,9957,9988,9935,9973,9930,9920,9950,9904,9935,9962,9948,9990,9998,9912,9963,9963,9942,9989,9929,9908,9979,9974,9940,9967,9939,9994,9927,9921,9973,9927,9998,9988,9963,9914,9984,9922,9997,9959,9967,9952,9981,9967,9968,9976,9960,9907,9945,9948,10000,9924,9954,9946,9996,9992,9957,9998,9900,9937,9950,9908,9951,9948,9957,9970,9921,9927,9962,9987,9926,9905,9991,9937,9962,9969,9911,9935,9915,9914,9948,9945,9939,9943,9982,9932,9965,9987,9936,9961,9966,9929,9959,10000,9904,9963,9964,9939,9943,9998,9976,9999,9925,9973,9962,9917,9933,9929,9951,9992,9964,9973,9982,9968,9909,9933,9953,9978,9901,9936,9937,9908,9906,9962,9953,9954,9963,9952,9930,9944,9928,9991,9952,9903,9990,9918,9960,9987,9933,9930,9936,9981,9938,9968,9908,9975,9963,9990,9968,9961,9982,9935,9944,9944,9949,9904,9975,9932,9980,9940,9923,9921,9992,9912,9966,9961,9971,9994,9930,9998,9950,9969,9915,9906,9950,9916,9926,9910,9968,9902,9943,9929,9940,9941,9909,9904,9917,9942,9954,9941,9974,9905,9987,9966,9910,9992,10000,9971,9930,9961,9970,9990,9986,9985,9972,9958,9916,9976,9919,9999,9955,9957,9907,9987,9907,9928,9922,9910,9943,9970,9934,9902,9960,9907,9916,9968,9931,9973,9967,9911,9921,9994,9993,9923,9901,9991,9991,9904,9921,9989,9926,9930,9932,9960,9912,9962,9957,9928,9978,9991,9959,9977,9954,9936,9987,9990,9902,9933,9989,9959,9953,9900,9992,9957,9906,9989,9950,9911,9922,9992,9956,9902,9946,9919,10000,9977,9952,9902,9954,9903,9981,9928,9955,9970,9904,9913,10000,9931,9974,9914,9967,9923,9940,9913,9938,9976,9915,9986,9925,9939,9998,9930,9942,9921,9947,9941,9947,9969,9926,9943,9964,9937,9905,9909,9912,9941,9951,9966,9924,9953,9917,9956,9906,9905,9931,9923,9951,9975,9967,9964,9932,9926,9917,9947,9994,9991,9938,9996,9964,9917,9917,9992,9906,9981,9988,9994,9997,10000,9921,9999,9955,9943,9986,9988,9993,9918,9920,9965,9945,9963,9917,9960,9947,9917,9948,9930,9902,9990,9973,9929,9939,9914,9994,9944,9921,9972,9928,9948,9903,9995,9964,9945,9971,9949,9912,9911,9981,9922,9921,9985,9940,9933,9974,9982,9950,9908,9914,9930,9961,9965,9987,9968,9964,9939,9913,9912,9939,9993,9962,9960,9997,9977,9916,9922,9940,9989,9925,9943,9911,9918,9931,9946,9984,9996,9906,9972,9952,9931,9968,9992,9950,9929,9915,9994,9937,9938,9946,9999,9945,9985,9979,9971,9979,9972,9983,9983,9917,9965,9982,9980,9981,9991,9963,9912,9974,9994,9932,9978,9916,9939,9927,9948,9922,9987,9936,9951,9943,9916,9933,9954,9946,9960,9902,9911,9911,9959,9902,9943,9996,9916,9910,9999,9972,9956,9994,9954,9916,9970,9942,9951,9953,9926,9915,9992,9996,9925,9931,9998,9905,9920,9920,9919,9936,9941,9943,9997,9966,9950,9907,9979,9993,9982,9900,9945,9952,9920,9918,9958,9993,9948,9995,9973,9971,9971,9909,9911,9963,9970,9953,9962,9981,9989,10000,9985,9916,9978,9936,9906,9922,9912,9940,9915,9956,9986,9943,9922,9920,9983,9962,9946,9927,9970,9996,9904,9948,9929,9986,9991,9998,9990,9913,9934,9973,9986,9955,9921,9973,9964,9909,9947,9922,9984,9942,9906,9952,9938,9980,9981,9968,9983,9969,9996,9967,9990,9943,9936,9926,9971,9911,9915,9924,9920,9902,9936,9931,9966,9999,9996,9913,9900,9923,9921,9925,9971,9957,9968,9954,9986,9970,9964,9943,9981,9980,9927,9935,9997,9967,9914,9901,9983,9917,9947,9966,9990,9989,9943,9970,9969,9987,9984,9975,9913,9985,9900,9979,9903,9926,9949,9979,9912,9983,9954,9959,9913,9959,9943,9917,9923,10000,9901,9957,9981,9919,9931,9986,9954,9991,9912,9967,10000,9908,9938,9998,9902,9978,9920,9900,10000,9917,9943,9984,9947,9938,9971,9964,9951,9950,9926,9934,9912,9942,9958,9978,9959,9921,9957,9933,9963,9934,9958,9965,9962,9981,9962,9963,9911,9931,9946,9988,9916,9949,9948,9924,9949,9921,9905,9922,9912,9964,9978,9928,9952,9964,9917,9970,9962,9909,9949,9944,9988,9909,9901,9946,9967,9903,9956,9988,9999,9916,9933,9937,9964,9965,9948,9957,9962,9990,9953,9929,9957,9975,9989,9933,9910,9914,9936,9953,9941,9995,9935,9946,9995,9935,9908,9913,9927,9997,9942,9965,9960,9936,9917,9962,9924,9983,9975,9949,9941,9907,9906,9921,9996,9991,9962,9932,9969,9928,9938,9909,9930,9992,9902,9992,9966,9924,9974,9976,9967,9908,9997,9928,9909,9976,9998,9911,9945,9963,9931,9968,9957,9958,9930,9925,9954,9902,9966,9956,9992,9944,9995,9933,9979,9967,9966,9909,9971,9962,9946,9948,9959,9965,9924,9984,9922,9945,9949,9906,9927,9965,9920,9941,9959,9970,9950,9938,9992,9912,9913,9985,9948,9914,9951,9980,9973,9953,9988,9946,9964,9902,9993,9985,9953,9902,9927,9934,9921,9924,9987,9937,9977,9900,9927,9911,9970,9976]
6537

okay... correct but slow..

stuck let me see the hints
Note that you can try all values in a brute force manner and find the maximum frequency of that value.
To find the maximum frequency of a value consider the biggest elements smaller than or equal to this value

hmm... not much help...
it is what I was doing

after checking out the discussion and ouch
I was so close to come to the sliding window.. but I drifted off
I had a hunch, k can at most fill how k gaps... if the window is bigger than the target... then
but missed the size a bit and went to a different direction

so the sliding window is

[1,4,8,13] k=5

i,j = 0
window-len = j-i+1
if sum-window+k >= target*window-len (nums[j] is the target to fill up to)
then this window can become j, i=j is a special case too

if legit grow j
if non-legit shrink window by growing i




*/

func maxFrequency(nums []int, k int) int {
	sort.Ints(nums)

	windowSum := nums[0]
	maxLen := 0
	for i, j := 0, 0; i <= j && j < len(nums); {
		windowLen := j - i + 1

		if windowSum+k >= nums[j]*windowLen {
			maxLen = max(maxLen, windowLen)
			if j < len(nums)-1 {
				windowSum += nums[j+1]
			}

			j++
		} else {
			windowSum -= nums[i]
			i++
		}

	}

	return maxLen
}

/*
Runtime: 209 ms, faster than 87.10% of Go online submissions for Frequency of the Most Frequent Element.
Memory Usage: 9.2 MB, less than 74.19% of Go online submissions for Frequency of the Most Frequent Element.


*/

func testMaxFrequency() {
	fmt.Println(maxFrequency([]int{9974, 9950, 9962, 9904, 9955, 9929, 9915, 9911, 9996, 9973, 9928, 9914, 9932, 9900, 9993, 9936, 9942, 9910, 9949, 9924, 9960, 9929, 9987, 9976, 9962, 9972, 9954, 9930, 9979, 10000, 9900, 9974, 9972, 9974, 9900, 9938, 9919, 9953, 9997, 9938, 9966, 9965, 9944, 9995, 9909, 9958, 9923, 9979, 9991, 9971, 10000, 9982, 9950, 9930, 9941, 9933, 9914, 9994, 9925, 9904, 9901, 9930, 9946, 9972, 9920, 9914, 9990, 9985, 9935, 9910, 9976, 9931, 9994, 9900, 9964, 9965, 9918, 9987, 9918, 9999, 9936, 9914, 9917, 9916, 9976, 9901, 9980, 9991, 9971, 9969, 9932, 9972, 9917, 9938, 9962, 9948, 9940, 9932, 9994, 9957, 9988, 9935, 9973, 9930, 9920, 9950, 9904, 9935, 9962, 9948, 9990, 9998, 9912, 9963, 9963, 9942, 9989, 9929, 9908, 9979, 9974, 9940, 9967, 9939, 9994, 9927, 9921, 9973, 9927, 9998, 9988, 9963, 9914, 9984, 9922, 9997, 9959, 9967, 9952, 9981, 9967, 9968, 9976, 9960, 9907, 9945, 9948, 10000, 9924, 9954, 9946, 9996, 9992, 9957, 9998, 9900, 9937, 9950, 9908, 9951, 9948, 9957, 9970, 9921, 9927, 9962, 9987, 9926, 9905, 9991, 9937, 9962, 9969, 9911, 9935, 9915, 9914, 9948, 9945, 9939, 9943, 9982, 9932, 9965, 9987, 9936, 9961, 9966, 9929, 9959, 10000, 9904, 9963, 9964, 9939, 9943, 9998, 9976, 9999, 9925, 9973, 9962, 9917, 9933, 9929, 9951, 9992, 9964, 9973, 9982, 9968, 9909, 9933, 9953, 9978, 9901, 9936, 9937, 9908, 9906, 9962, 9953, 9954, 9963, 9952, 9930, 9944, 9928, 9991, 9952, 9903, 9990, 9918, 9960, 9987, 9933, 9930, 9936, 9981, 9938, 9968, 9908, 9975, 9963, 9990, 9968, 9961, 9982, 9935, 9944, 9944, 9949, 9904, 9975, 9932, 9980, 9940, 9923, 9921, 9992, 9912, 9966, 9961, 9971, 9994, 9930, 9998, 9950, 9969, 9915, 9906, 9950, 9916, 9926, 9910, 9968, 9902, 9943, 9929, 9940, 9941, 9909, 9904, 9917, 9942, 9954, 9941, 9974, 9905, 9987, 9966, 9910, 9992, 10000, 9971, 9930, 9961, 9970, 9990, 9986, 9985, 9972, 9958, 9916, 9976, 9919, 9999, 9955, 9957, 9907, 9987, 9907, 9928, 9922, 9910, 9943, 9970, 9934, 9902, 9960, 9907, 9916, 9968, 9931, 9973, 9967, 9911, 9921, 9994, 9993, 9923, 9901, 9991, 9991, 9904, 9921, 9989, 9926, 9930, 9932, 9960, 9912, 9962, 9957, 9928, 9978, 9991, 9959, 9977, 9954, 9936, 9987, 9990, 9902, 9933, 9989, 9959, 9953, 9900, 9992, 9957, 9906, 9989, 9950, 9911, 9922, 9992, 9956, 9902, 9946, 9919, 10000, 9977, 9952, 9902, 9954, 9903, 9981, 9928, 9955, 9970, 9904, 9913, 10000, 9931, 9974, 9914, 9967, 9923, 9940, 9913, 9938, 9976, 9915, 9986, 9925, 9939, 9998, 9930, 9942, 9921, 9947, 9941, 9947, 9969, 9926, 9943, 9964, 9937, 9905, 9909, 9912, 9941, 9951, 9966, 9924, 9953, 9917, 9956, 9906, 9905, 9931, 9923, 9951, 9975, 9967, 9964, 9932, 9926, 9917, 9947, 9994, 9991, 9938, 9996, 9964, 9917, 9917, 9992, 9906, 9981, 9988, 9994, 9997, 10000, 9921, 9999, 9955, 9943, 9986, 9988, 9993, 9918, 9920, 9965, 9945, 9963, 9917, 9960, 9947, 9917, 9948, 9930, 9902, 9990, 9973, 9929, 9939, 9914, 9994, 9944, 9921, 9972, 9928, 9948, 9903, 9995, 9964, 9945, 9971, 9949, 9912, 9911, 9981, 9922, 9921, 9985, 9940, 9933, 9974, 9982, 9950, 9908, 9914, 9930, 9961, 9965, 9987, 9968, 9964, 9939, 9913, 9912, 9939, 9993, 9962, 9960, 9997, 9977, 9916, 9922, 9940, 9989, 9925, 9943, 9911, 9918, 9931, 9946, 9984, 9996, 9906, 9972, 9952, 9931, 9968, 9992, 9950, 9929, 9915, 9994, 9937, 9938, 9946, 9999, 9945, 9985, 9979, 9971, 9979, 9972, 9983, 9983, 9917, 9965, 9982, 9980, 9981, 9991, 9963, 9912, 9974, 9994, 9932, 9978, 9916, 9939, 9927, 9948, 9922, 9987, 9936, 9951, 9943, 9916, 9933, 9954, 9946, 9960, 9902, 9911, 9911, 9959, 9902, 9943, 9996, 9916, 9910, 9999, 9972, 9956, 9994, 9954, 9916, 9970, 9942, 9951, 9953, 9926, 9915, 9992, 9996, 9925, 9931, 9998, 9905, 9920, 9920, 9919, 9936, 9941, 9943, 9997, 9966, 9950, 9907, 9979, 9993, 9982, 9900, 9945, 9952, 9920, 9918, 9958, 9993, 9948, 9995, 9973, 9971, 9971, 9909, 9911, 9963, 9970, 9953, 9962, 9981, 9989, 10000, 9985, 9916, 9978, 9936, 9906, 9922, 9912, 9940, 9915, 9956, 9986, 9943, 9922, 9920, 9983, 9962, 9946, 9927, 9970, 9996, 9904, 9948, 9929, 9986, 9991, 9998, 9990, 9913, 9934, 9973, 9986, 9955, 9921, 9973, 9964, 9909, 9947, 9922, 9984, 9942, 9906, 9952, 9938, 9980, 9981, 9968, 9983, 9969, 9996, 9967, 9990, 9943, 9936, 9926, 9971, 9911, 9915, 9924, 9920, 9902, 9936, 9931, 9966, 9999, 9996, 9913, 9900, 9923, 9921, 9925, 9971, 9957, 9968, 9954, 9986, 9970, 9964, 9943, 9981, 9980, 9927, 9935, 9997, 9967, 9914, 9901, 9983, 9917, 9947, 9966, 9990, 9989, 9943, 9970, 9969, 9987, 9984, 9975, 9913, 9985, 9900, 9979, 9903, 9926, 9949, 9979, 9912, 9983, 9954, 9959, 9913, 9959, 9943, 9917, 9923, 10000, 9901, 9957, 9981, 9919, 9931, 9986, 9954, 9991, 9912, 9967, 10000, 9908, 9938, 9998, 9902, 9978, 9920, 9900, 10000, 9917, 9943, 9984, 9947, 9938, 9971, 9964, 9951, 9950, 9926, 9934, 9912, 9942, 9958, 9978, 9959, 9921, 9957, 9933, 9963, 9934, 9958, 9965, 9962, 9981, 9962, 9963, 9911, 9931, 9946, 9988, 9916, 9949, 9948, 9924, 9949, 9921, 9905, 9922, 9912, 9964, 9978, 9928, 9952, 9964, 9917, 9970, 9962, 9909, 9949, 9944, 9988, 9909, 9901, 9946, 9967, 9903, 9956, 9988, 9999, 9916, 9933, 9937, 9964, 9965, 9948, 9957, 9962, 9990, 9953, 9929, 9957, 9975, 9989, 9933, 9910, 9914, 9936, 9953, 9941, 9995, 9935, 9946, 9995, 9935, 9908, 9913, 9927, 9997, 9942, 9965, 9960, 9936, 9917, 9962, 9924, 9983, 9975, 9949, 9941, 9907, 9906, 9921, 9996, 9991, 9962, 9932, 9969, 9928, 9938, 9909, 9930, 9992, 9902, 9992, 9966, 9924, 9974, 9976, 9967, 9908, 9997, 9928, 9909, 9976, 9998, 9911, 9945, 9963, 9931, 9968, 9957, 9958, 9930, 9925, 9954, 9902, 9966, 9956, 9992, 9944, 9995, 9933, 9979, 9967, 9966, 9909, 9971, 9962, 9946, 9948, 9959, 9965, 9924, 9984, 9922, 9945, 9949, 9906, 9927, 9965, 9920, 9941, 9959, 9970, 9950, 9938, 9992, 9912, 9913, 9985, 9948, 9914, 9951, 9980, 9973, 9953, 9988, 9946, 9964, 9902, 9993, 9985, 9953, 9902, 9927, 9934, 9921, 9924, 9987, 9937, 9977, 9900, 9927, 9911, 9970, 9976}, 6537))
}
